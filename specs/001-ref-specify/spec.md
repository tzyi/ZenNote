# Feature Specification: 參考 ref_specify.md 功能總覽

**Feature Branch**: `001-ref-specify`  
**Created**: 2026-02-14  
**Status**: Draft  
**Input**: User description: "請參考 ref_specify.md (See <attachments> above for file contents. You may not need to search or read the file again.)"



## User Scenarios & Testing *(mandatory)*

### User Story 1 - 主畫面卡片瀏覽與操作 (Priority: P1)

使用者可於主畫面依時間倒序瀏覽所有卡片，點擊卡片可展開並進入編輯，長按可開啟操作選單（刪除、分享、置頂），支援無限滾動與批次匯出。

**Why this priority**: 主畫面為所有筆記的入口，影響用戶體驗與資料存取效率。

**Independent Test**: 於無網路環境下啟動 APP，主畫面能於 500ms 內顯示 10 張卡片，並可正常操作卡片。

**Acceptance Scenarios**:

1. **Given** APP 首次啟動，**When** 進入主畫面，**Then** 500ms 內顯示 10 張卡片。
2. **Given** 使用者於主畫面，**When** 下滑滾動，**Then** 持續載入更多卡片且動畫流暢。

3. **Given** 使用者長按卡片，**When** 選擇刪除，**Then** 該卡片進入回收桶並顯示剩餘天數。
4. **Given** 使用者進入回收桶頁面，**When** 點擊「全部清空」或批量選取刪除，**Then** 僅此時才會刪除超過 14 天的筆記。
5. **Given** 使用者點擊卡片，**When** 內容超過 5 行，**Then** 顯示「展開」按鈕。
6. **Given** 使用者選擇多筆卡片，**When** 執行批次匯出，**Then** 匯出 Markdown 檔案。

---

### User Story 2 - 筆記編輯器互動 (Priority: P2)

使用者可於編輯器新增/編輯筆記，插入標籤、圖片，支援自動儲存草稿與標籤自動補全。

**Why this priority**: 筆記編輯為核心功能，需確保資料不遺失並提升輸入效率。

**Independent Test**: 於無網路環境下進入編輯器，輸入內容後 5 秒自動儲存草稿，離開時顯示「已儲存」。

**Acceptance Scenarios**:

1. **Given** 進入編輯器，**When** 輸入內容，**Then** 5 秒內自動儲存草稿。
2. **Given** 輸入 #，**When** 彈出標籤清單，**Then** 可模糊搜尋與新建標籤。
3. **Given** 上傳多張圖片，**When** 拖曳排序，**Then** 圖片順序即時更新。
4. **Given** 編輯器開啟，**When** 鍵盤彈出，**Then** 工具列不被遮擋。

---

### User Story 3 - 搜尋與多維度篩選 (Priority: P3)

使用者可於搜尋頁輸入多關鍵字，並以 AND/OR、標籤、日期等多維度篩選筆記。

**Why this priority**: 強大搜尋提升資料檢索效率，支援多條件組合。

**Independent Test**: 於搜尋頁輸入多組關鍵字，能於 100ms 內顯示正確結果，並可切換 AND/OR。

**Acceptance Scenarios**:

1. **Given** 搜尋頁輸入 >3 字，**When** 空格分隔多關鍵字，**Then** 結果即時顯示。
2. **Given** 點擊篩選 Chips，**When** 選擇屬性，**Then** 結果列表動畫過渡。
3. **Given** 選擇多個標籤，**When** 執行搜尋，**Then** 僅顯示符合條件之筆記。

---

### User Story 4 - 左邊側邊欄互動與標籤管理 (Priority: P2)

使用者可於左側側邊欄瀏覽統計熱力圖、管理標籤、快速導航至全部筆記/每日回顧，並可拖曳排序標籤。

**Why this priority**: 側邊欄整合統計、標籤管理與導航，是提升資料組織與檢索效率的關鍵。

**Independent Test**: 於主畫面左滑開啟側邊欄，200ms 內顯示統計與標籤列表，拖曳排序後標籤順序即時更新。

**Acceptance Scenarios**:

1. **Given** 主畫面，**When** 左滑或點擊漢堡選單，**Then** 200ms 內展開側邊欄並顯示統計熱力圖。
2. **Given** 側邊欄開啟，**When** 點擊標籤，**Then** 跳轉至該標籤聚合視圖。
3. **Given** 側邊欄開啟，**When** 拖曳標籤排序，**Then** 標籤順序即時儲存並同步顯示。
4. **Given** 側邊欄開啟，**When** 新增/編輯/刪除標籤，**Then** 標籤列表即時更新。
5. **Given** 側邊欄開啟，**When** 點擊「全部筆記」或「每日回顧」，**Then** 導航至對應頁面。
6. **Given** 側邊欄開啟，**When** 點擊設定按鈕，**Then** 進入設定頁面。

---

### User Story 5 - 設定頁面與資料管理 (Priority: P3)

使用者可於設定頁切換主題、匯入/匯出資料、管理回收桶、本地備份還原與一鍵重設。

**Why this priority**: 設定頁整合資料安全、主題體驗與資料管理，確保用戶資料完整與操作便利。

**Independent Test**: 於設定頁切換主題即時生效，匯出/匯入資料後資料正確顯示，回收桶批次操作與備份還原皆可正常執行。

**Acceptance Scenarios**:

1. **Given** 進入設定頁，**When** 切換深色/淺色主題，**Then** UI 立即切換並跟隨系統設定。
2. **Given** 設定頁，**When** 執行多筆筆記批次匯出，**Then** 產生 .zip 檔包含 Markdown 與圖片。
3. **Given** 設定頁，**When** 匯入 .zip 或 Markdown 檔，**Then** 筆記、標籤、圖片正確解析並自動去重。
4. **Given** 設定頁，**When** 點擊回收桶管理，**Then** 可多選批次還原/刪除，並有「全部清空」功能。
5. **Given** 設定頁，**When** 執行本地備份或還原，**Then** 所有資料正確備份/還原。
6. **Given** 設定頁，**When** 點擊一鍵重設，**Then** 所有資料恢復初始狀態。
7. **Given** 設定頁，**When** 查看關於，**Then** 僅顯示版本資訊。

---


### Edge Cases

- 筆記超過 1 萬筆時，主畫面滾動效能是否維持 60fps？
- 單筆筆記插入超過 10 張圖片時，是否正確顯示警告？
- 搜尋無結果時，是否僅顯示「無結果」提示？
- 回收桶筆記超過 14 天未還原，僅於用戶點擊「全部清空」或批量選取刪除時才會真正刪除。
- 標籤超過 1000 個時，管理與搜尋是否流暢？


## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系統必須於主畫面以時間倒序顯示所有卡片，支援無限滾動。
- **FR-002**: 每張卡片需顯示精確時間戳、內容預覽、標籤徽章、更多操作。
- **FR-003**: 內容預覽預設顯示 5 行，超過以「展開」按鈕顯示全部內容。
- **FR-004**: 標籤徽章最多同時顯示 5 個，超過以「+N」收斂。
- **FR-005**: 支援多筆筆記批次匯出（Markdown 格式）。
- **FR-006**: 筆記刪除後進入回收桶，僅於用戶於回收桶頁面點擊「全部清空」或批量選取刪除時，才會刪除超過 14 天的筆記，可還原。
- **FR-007**: 編輯器支援標籤插入、圖片上傳、圖片排序、標籤自動補全。
- **FR-008**: 編輯器需自動儲存草稿（5 秒 debounce），離開時顯示「已儲存」。
- **FR-009**: 搜尋頁支援多關鍵字 AND/OR 搜尋、標籤多選、屬性 Chips 篩選。
- **FR-010**: 搜尋結果於 100ms 內顯示，支援相關性排序。
- **FR-011**: 側邊欄支援標籤管理、拖曳排序、統計顯示。
- **FR-012**: 設定頁支援主題切換、資料匯入/匯出、回收桶管理、本地備份還原、一鍵重設。
- **FR-013**: 所有資料僅儲存於本地，不支援雲端同步。
- **FR-014**: UI 必須與設計稿完全一致。

### Key Entities *(include if feature involves data)*

- **Note（筆記）**：包含內容、標籤、圖片、建立/修改時間、刪除狀態、回收桶剩餘天數。
- **Tag（標籤）**：名稱、關聯筆記數量、排序權重。
- **Image（圖片）**：檔案路徑、所屬筆記、排序。
- **RecycleBin（回收桶）**：已刪除筆記、刪除時間、剩餘天數。
- **Settings（設定）**：主題、備份檔案路徑、匯入/匯出紀錄。


## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 首次載入主畫面 500ms 內顯示 10 張卡片。
- **SC-002**: 筆記列表滾動效能維持 60fps（1 萬筆資料下）。
- **SC-003**: 搜尋結果於 100ms 內顯示。
- **SC-004**: 編輯器草稿自動儲存成功率 100%。
- **SC-005**: 90% 以上用戶可於 1 分鐘內完成新增/搜尋/匯出筆記。
- **SC-006**: UI 與設計稿比對一致性達 100%。
- **SC-007**: 回收桶筆記僅於用戶主動操作（全部清空或批量選取刪除）時才會刪除超過 14 天的筆記。
